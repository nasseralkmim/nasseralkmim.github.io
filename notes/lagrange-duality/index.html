<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="../../lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="../../lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="../../lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="../../lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Lagrangian duality example using ob-python | Notes repository</title>
  <link rel = 'canonical' href = 'https://nasseralkmim.github.io/notes/lagrange-duality/'>
  <meta name="description" content="This is a page where I collect some of my post-worthy notes and some projects that I have worked on.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Lagrangian duality example using ob-python" />
<meta property="og:description" content="Lagrandian duality example" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nasseralkmim.github.io/notes/lagrange-duality/" /><meta property="article:section" content="notes" />
<meta property="article:published_time" content="2016-03-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-03-10T00:00:00+00:00" />


  <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Lagrangian duality example using ob-python"/>
<meta name="twitter:description" content="Lagrandian duality example"/>

  
  
    
  
  
  <link rel="stylesheet" href="https://nasseralkmim.github.io/css/styles.65831b452b67d5d2710711427b0897003fc39f6def8a75876f8cc085d6d6f23715d716318ba718e6a68229ec094eb53a4008f4ad1569f6c3b0a95647797620e2.css" integrity="sha512-ZYMbRStn1dJxBxFCewiXAD/Dn23vinWHb4zAhdbW8jcV1xYxi6cY5qaCKewJTrU6QAj0rRVp9sOwqVZHeXYg4g=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://nasseralkmim.github.io/images/favicon.ico" />

  
  
  
  
  
    
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-74704246-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
  
<script src=../../js/toc.js></script>
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="../../">home</a></li>
         
        <li><a href="../../notes">notes</a></li>
         
        <li><a href="../../tags">tags</a></li>
         
        <li><a href="../../about">about</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://nasseralkmim.github.io/notes/lagrange-multiplier/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://nasseralkmim.github.io/notes/oop-fem/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&text=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&title=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&is_video=false&description=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Lagrangian%20duality%20example%20using%20ob-python&body=Check out this article: https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&title=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&title=Lagrangian%20duality%20example%20using%20ob-python" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&name=Lagrangian%20duality%20example%20using%20ob-python&description=Lagrandian%20duality%20example" aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&t=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
<ul>
<li><a href="#headline-1">Introduction</a>
</li>
<li><a href="#headline-2">Problem statement</a>
<ul>
<li><a href="#headline-3">Visualization of the objective function</a>
</li>
<li><a href="#headline-4">Visualization of the restrained domain</a>
</li>
<li><a href="#headline-5">Visualization with contour plot </a>
</li>
</ul>
</li>
<li><a href="#headline-6">Optimize with Lagrangian duality</a>
<ul>
<li><a href="#headline-7">Form the Lagrangian function </a>
</li>
<li><a href="#headline-8">Compute the function derivatives</a>
</li>
<li><a href="#headline-9">Minimization procedure</a>
</li>
<li><a href="#headline-10">Find the minimum for each variable</a>
</li>
<li><a href="#headline-11">Form the dual objective function</a>
</li>
<li><a href="#headline-12">Visualize the dual objective function</a>
</li>
<li><a href="#headline-13">Maximize the dual objective function</a>
</li>
<li><a href="#headline-14">The final solution</a>
</li>
<li><a href="#headline-15">Visualize the final solution</a>
</li>
</ul>
</li>
<li><a href="#headline-16">Conclusion</a>
</li>
</ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Lagrangian duality example using ob-python
      </h1>
      <div class="meta">
        
        
        
        
        
        
        
        
        
        <div class="postdate">
          
          <time datetime="2016-03-10 00:00:00 &#43;0000 UTC" itemprop="datePublished">Mar 10 2016</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          5 minute read
        </div>
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="../../tags/math" rel="tag">math</a>
            
             ,  
            <a class="tag-link" href="../../tags/python" rel="tag">python</a>
            
             ,  
            <a class="tag-link" href="../../tags/optimization" rel="tag">optimization</a>
            
        </div>
        
      </div>
    </header>

  
    <div class="article-gallery">
      
      <a class="gallery-item" href="../../notes/lagrange-duality/img/lagr1.png" rel="gallery_0">
          <img src="../../notes/lagrange-duality/img/lagr1.png" itemprop="image" />
      </a>
      
      <a class="gallery-item" href="../../notes/lagrange-duality/img/lagr2.png" rel="gallery_1">
          <img src="../../notes/lagrange-duality/img/lagr2.png" itemprop="image" />
      </a>
      
      <a class="gallery-item" href="../../notes/lagrange-duality/img/lagr3.png" rel="gallery_2">
          <img src="../../notes/lagrange-duality/img/lagr3.png" itemprop="image" />
      </a>
      
      <a class="gallery-item" href="../../notes/lagrange-duality/img/lagr4.png" rel="gallery_3">
          <img src="../../notes/lagrange-duality/img/lagr4.png" itemprop="image" />
      </a>
      
      <a class="gallery-item" href="../../notes/lagrange-duality/img/lagr5.png" rel="gallery_4">
          <img src="../../notes/lagrange-duality/img/lagr5.png" itemprop="image" />
      </a>
      
      <a class="gallery-item" href="../../notes/lagrange-duality/img/lagr6.png" rel="gallery_5">
          <img src="../../notes/lagrange-duality/img/lagr6.png" itemprop="image" />
      </a>
      
    </div>
  
    
    <div class="content" itemprop="articleBody">
      
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Introduction
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>
This is an example extracted from &#34;An Introduction to Structural Optimization&#34;, I also added a few extra images to clarify some points.</p>
<ol>
<li>What is Lagrangian duality?</li>
<li>Why is it called Lagrangian duality?</li>
</ol>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Problem statement
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>
We want to optimize the following convex and separable problem,</p>
\begin{equation}
\mathbb{(P)} \;
\begin{cases}
\min \limits_{x_1, x_2} (x_1 -3)^2 + (x_2 + 1)^2 \\
s.t \begin{cases}
x_1+x_2-1.5 \le 0 \\
\boldsymbol x \in \chi = { \boldsymbol x \; : \; 0 \le x_1 \le 1, -2 \le x_2 \le 1}.
\end{cases}
\end{cases}
\end{equation}
<div id="outline-container-headline-3" class="outline-4">
<h4 id="headline-3">
Visualization of the objective function
</h4>
<div id="outline-text-headline-3" class="outline-text-4">
<p>
The objective function can be visualized as the following,</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#666">%</span>matplotlib inline
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">matplotlib.pyplot</span> <span style="color:#a2f;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">plt</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#a2f;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">mpl_toolkits.mplot3d</span> <span style="color:#a2f;font-weight:bold">import</span> Axes3D
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span> <span style="color:#a2f;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">np</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>fig <span style="color:#666">=</span> plt<span style="color:#666">.</span>figure()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>ax <span style="color:#666">=</span> Axes3D(fig)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>ax<span style="color:#666">.</span>set_xlabel(<span style="color:#b44">&#39;x&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>ax<span style="color:#666">.</span>set_ylabel(<span style="color:#b44">&#39;y&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>x1 <span style="color:#666">=</span> np<span style="color:#666">.</span>linspace(<span style="color:#666">0</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>x2 <span style="color:#666">=</span> np<span style="color:#666">.</span>linspace(<span style="color:#666">-</span><span style="color:#666">2</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>X1, X2 <span style="color:#666">=</span> np<span style="color:#666">.</span>meshgrid(x1, x2)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>X3 <span style="color:#666">=</span> (X1 <span style="color:#666">-</span> <span style="color:#666">3</span>)<span style="color:#666">**</span><span style="color:#666">2</span> <span style="color:#666">+</span> (X2 <span style="color:#666">+</span> <span style="color:#666">1</span>)<span style="color:#666">**</span><span style="color:#666">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>ax<span style="color:#666">.</span>plot_surface(X1, X2, X3, cmap<span style="color:#666">=</span><span style="color:#b44">&#39;plasma&#39;</span>)</span></span></code></pre></div>
</div>
<p><img src="img/lagr1.png" alt="img/lagr1.png" title="img/lagr1.png" /></p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-4">
<h4 id="headline-4">
Visualization of the restrained domain
</h4>
<div id="outline-text-headline-4" class="outline-text-4">
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>xr1 <span style="color:#666">=</span> np<span style="color:#666">.</span>linspace(<span style="color:#666">0</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>xr2 <span style="color:#666">=</span> <span style="color:#666">1.5</span> <span style="color:#666">-</span> xr1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>xr3 <span style="color:#666">=</span> (xr1 <span style="color:#666">-</span> <span style="color:#666">3</span>)<span style="color:#666">**</span><span style="color:#666">2</span> <span style="color:#666">+</span> (xr2 <span style="color:#666">+</span> <span style="color:#666">1</span>)<span style="color:#666">**</span><span style="color:#666">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>xp3 <span style="color:#666">=</span> np<span style="color:#666">.</span>linspace(<span style="color:#666">0</span>, <span style="color:#666">16</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>XP1, XP3 <span style="color:#666">=</span> np<span style="color:#666">.</span>meshgrid(xr1, xp3)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>XP2 <span style="color:#666">=</span> <span style="color:#666">-</span>XP1 <span style="color:#666">+</span> <span style="color:#666">1.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>fig <span style="color:#666">=</span> plt<span style="color:#666">.</span>figure()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>ax <span style="color:#666">=</span> Axes3D(fig)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>ax<span style="color:#666">.</span>set_ylim(<span style="color:#666">-</span><span style="color:#666">2</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>ax<span style="color:#666">.</span>plot_surface(XP1, XP2, XP3, cmap<span style="color:#666">=</span><span style="color:#b44">&#39;gray&#39;</span>, cstride<span style="color:#666">=</span><span style="color:#666">100</span>, rstride<span style="color:#666">=</span><span style="color:#666">100</span>, edgecolor<span style="color:#666">=</span><span style="color:#b44">&#39;w&#39;</span>, alpha<span style="color:#666">=</span><span style="color:#666">0.15</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>ax<span style="color:#666">.</span>plot_surface(X1, X2, X3, cmap<span style="color:#666">=</span><span style="color:#b44">&#39;plasma&#39;</span>,  cstride<span style="color:#666">=</span><span style="color:#666">3</span>, rstride<span style="color:#666">=</span><span style="color:#666">3</span>, edgecolor<span style="color:#666">=</span><span style="color:#b44">&#39;w&#39;</span>, alpha<span style="color:#666">=</span><span style="color:#666">0.5</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>ax<span style="color:#666">.</span>plot(xr1, xr2, color<span style="color:#666">=</span><span style="color:#b44">&#39;k&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>ax<span style="color:#666">.</span>plot(xr1, xr2, xr3, color<span style="color:#666">=</span><span style="color:#b44">&#39;w&#39;</span>)</span></span></code></pre></div>
</div>
<p><img src="img/lagr2.png" alt="img/lagr2.png" title="img/lagr2.png" /></p>
<p>
<em>note:</em> if anyone knows a better way to represent this domain restriction please share with me.</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-4">
<h4 id="headline-5">
Visualization with contour plot 
</h4>
<div id="outline-text-headline-5" class="outline-text-4">
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>fig <span style="color:#666">=</span> plt<span style="color:#666">.</span>figure(figsize<span style="color:#666">=</span>(<span style="color:#666">10</span>,<span style="color:#666">10</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>ax <span style="color:#666">=</span> fig<span style="color:#666">.</span>add_subplot(<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>ax<span style="color:#666">.</span>set_ylabel(<span style="color:#b44">&#39;y&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>ax<span style="color:#666">.</span>set_xlabel(<span style="color:#b44">&#39;x&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>ax<span style="color:#666">.</span>set_aspect(<span style="color:#b44">&#39;equal&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>ax<span style="color:#666">.</span>set_ylim(<span style="color:#666">-</span><span style="color:#666">2</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>CS <span style="color:#666">=</span> ax<span style="color:#666">.</span>contour(X1, X2, X3, colors<span style="color:#666">=</span><span style="color:#b44">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>ax<span style="color:#666">.</span>clabel(CS)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>ax<span style="color:#666">.</span>plot(xr1, xr2, <span style="color:#b44">&#39;k&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>ax<span style="color:#666">.</span>fill_between(xr1, xr2, <span style="color:#666">-</span><span style="color:#666">2</span>, alpha<span style="color:#666">=</span><span style="color:#666">0.4</span>)</span></span></code></pre></div>
</div>
<p><img src="img/lagr4.png" alt="img/lagr4.png" title="img/lagr4.png" /></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-6" class="outline-2">
<h2 id="headline-6">
Optimize with Lagrangian duality
</h2>
<div id="outline-text-headline-6" class="outline-text-2">
<div id="outline-container-headline-7" class="outline-4">
<h4 id="headline-7">
Form the Lagrangian function 
</h4>
<div id="outline-text-headline-7" class="outline-text-4">
<p>The Lagrangian function that connects the objective function with its restrictions is</p>
\begin{equation}
\mathcal{L} = (x_1 - 3)^2 + (x_2 +1)^2 + \lambda(x_1 + x_2-1.5).
\end{equation}
<p>
This function enable us to separate each variable, </p>
\begin{equation}
\mathcal{L} = \underbrace{(x_1 - 3)^2 +  \lambda(x_1)}_{\mathcal{L}_1} +\underbrace{ (x_2 +1)^2 + \lambda x_2-1.5}_{\mathcal{L}_2}.
\end{equation}
</div>
</div>
<div id="outline-container-headline-8" class="outline-4">
<h4 id="headline-8">
Compute the function derivatives
</h4>
<div id="outline-text-headline-8" class="outline-text-4">
<p>
Differentiation of them results in</p>
\begin{equation}
\dfrac{\partial \mathcal{L}_1}{\partial x_1} = 2 x_1 + \lambda - 6, \qquad \dfrac{\partial \mathcal{L}_2}{\partial x_2} = 2 x_2 +\lambda +2.
\end{equation}
</div>
</div>
<div id="outline-container-headline-9" class="outline-4">
<h4 id="headline-9">
Minimization procedure
</h4>
<div id="outline-text-headline-9" class="outline-text-4">
<p>
The minimization of the Lagrangian function with each separable variable is performed as follows,</p>
<ol>
<li>$\dfrac{ \partial \mathcal{L_j}(x_j^{min})}{\partial x_j} \ge 0$ then because the tendency of the function at its minimum is to increase implies that the point that minimizes the function is the minimum itself, $x^* = x^{min}$.</li>
<li>$\dfrac{ \partial \mathcal{L_j}(x_j^{max})}{\partial x_j} \le 0$ implies, with the same logic, that the point that minimizes the Lagrangian coincides with the maximum of the restriction $x^* = x^{max}$.</li>
</ol>
<p>We can try visualize this logic with a generic quadratic function,</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>x <span style="color:#666">=</span> np<span style="color:#666">.</span>linspace(<span style="color:#666">-</span><span style="color:#666">5</span>, <span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>x1 <span style="color:#666">=</span> np<span style="color:#666">.</span>linspace(<span style="color:#666">2</span>, <span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>y <span style="color:#666">=</span> x<span style="color:#666">**</span><span style="color:#666">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>y1 <span style="color:#666">=</span> x1<span style="color:#666">**</span><span style="color:#666">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>dy <span style="color:#666">=</span> <span style="color:#666">4</span><span style="color:#666">*</span>x <span style="color:#666">-</span> <span style="color:#666">4</span> <span style="color:#080;font-style:italic"># tangent line at x=2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>fig <span style="color:#666">=</span> plt<span style="color:#666">.</span>figure()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>ax <span style="color:#666">=</span> fig<span style="color:#666">.</span>add_subplot(<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>ax<span style="color:#666">.</span>set_xlabel(<span style="color:#b44">&#39;x&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>ax<span style="color:#666">.</span>set_ylabel(<span style="color:#b44">&#39;y&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>ax<span style="color:#666">.</span>set_xlim(<span style="color:#666">-</span><span style="color:#666">2</span>, <span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>ax<span style="color:#666">.</span>set_ylim(<span style="color:#666">0</span>, <span style="color:#666">20</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>ax<span style="color:#666">.</span>plot(x, y, <span style="color:#b44">&#39;--k&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>ax<span style="color:#666">.</span>plot(x1, y1, <span style="color:#b44">&#39;Tomato&#39;</span>, lw<span style="color:#666">=</span><span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>ax<span style="color:#666">.</span>plot(x, dy, <span style="color:#b44">&#39;SteelBlue&#39;</span>)</span></span></code></pre></div>
</div>
<p><img src="img/lagr3.png" alt="img/lagr3.png" title="img/lagr3.png" /></p>
<p>
So, lets say we have a quadratic function limited by $x^{min}=2$ and $x^{max}=5$ (in tomato color), if the take the function derivative and evaluated it at $x^{min}=2$ we would get a positive value, since the function is increasing at this point. So, the minimum of the function happens at the interval minimum extreme.</p>
</div>
</div>
<div id="outline-container-headline-10" class="outline-4">
<h4 id="headline-10">
Find the minimum for each variable
</h4>
<div id="outline-text-headline-10" class="outline-text-4">
<p>
In order to perform the minimization of the Lagrangian in each variable we test the gradients at the extremes, the point where the minimum occurs is represented by $x^*$.</p>
\begin{equation}
 \dfrac{\partial \mathcal{L_1(0, \lambda)}_1}{\partial x_1} = \lambda - 6 \ge 0 \qquad x_1^* = 0, \; if \; \lambda \ge 6 
\end{equation}
\begin{equation}
\dfrac{\partial \mathcal{L_1(1, \lambda)}_1}{\partial x_1} = \lambda - 4 \le 0 \qquad x_1^* = 1, \; if \;0 \le \lambda \ge 4 
\end{equation}
\begin{equation}
\dfrac{\partial \mathcal{L_1(x_1, \lambda)}_1}{\partial x_1} = 2x_1+\lambda - 6 = 0 \qquad x_1^* = 3-\dfrac{\lambda}{2}, \; if \; 4 \le \lambda \ge 6 
\end{equation}
<p>
and for $\mathcal{L_2}$,</p>
\begin{equation}
 \dfrac{\partial \mathcal{L_2(-2, \lambda)}_1}{\partial x_2} = \lambda - 2 \ge 0 \qquad x_1^* = -2, \; if \; \lambda \ge 2 
\end{equation}
\begin{equation}
\dfrac{\partial \mathcal{L_2(1, \lambda)}_1}{\partial x_2} = \lambda + 4 \le 0 \qquad \text{never satisfied because} \lambda \ge 0
\end{equation}
\begin{equation}
\dfrac{\partial \mathcal{L_2(x_2, \lambda)}_1}{\partial x_2} = 2x_2+\lambda +2 = 0 \qquad x_2^* = -1-\dfrac{\lambda}{2}, \; if \; 0 \le \lambda \ge 2.
\end{equation}
</div>
</div>
<div id="outline-container-headline-11" class="outline-4">
<h4 id="headline-11">
Form the dual objective function
</h4>
<div id="outline-text-headline-11" class="outline-text-4">
<p>
The dual objective functions is the minimum of the Lagrangian function, </p>
\begin{equation}
\phi (\lambda) = \min \limits_{\boldsymbol x \in \chi} \mathcal{L} = \min \limits_{\boldsymbol x \in \chi} \sum_{j=1}^n \mathcal{L}_j,
\end{equation}
<p>
or, the sum of the Lagrangian minimum on each variable, $\min \mathcal{L}_j$.</p>
\begin{equation}
\phi (\lambda) = (x_1^*-3)^2 + \lambda x_1^* + (x_2^* + 1)^2 + \lambda x_2^* - \dfrac{3}{2}\lambda
\end{equation}
<p>
where $x_1^*$ and $x_2^*$ represent the points where the function is minimum.</p>
<p>
This can be divided for each $\lambda$ interval,</p>
\begin{equation}
\begin{cases}
 -\dfrac{\lambda^2}{4}  -\dfrac{3}{2}\lambda + 4, \qquad 0 \le \lambda \le 2\\
 -\dfrac{5}{2} \lambda +5,  \qquad 2 \le \lambda \le 4\\
 -\dfrac{\lambda^2}{4} - \dfrac{\lambda}{2} +1, \qquad 4 \le \lambda \le 6\\
 -\dfrac{7}{2} \lambda + 10, \qquad \lambda \ge 6
\end{cases}
\end{equation}
</div>
</div>
<div id="outline-container-headline-12" class="outline-4">
<h4 id="headline-12">
Visualize the dual objective function
</h4>
<div id="outline-text-headline-12" class="outline-text-4">
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>lambd <span style="color:#666">=</span> np<span style="color:#666">.</span>linspace(<span style="color:#666">0</span>, <span style="color:#666">10</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">phi</span>(lambd):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#a2f;font-weight:bold">return</span> ((<span style="color:#666">0</span> <span style="color:#666">&lt;=</span> lambd <span style="color:#666">&lt;=</span><span style="color:#666">2</span>)<span style="color:#666">*</span>(<span style="color:#666">-</span>lambd<span style="color:#666">**</span><span style="color:#666">2</span><span style="color:#666">/</span><span style="color:#666">4</span> <span style="color:#666">-</span><span style="color:#666">3</span><span style="color:#666">/</span><span style="color:#666">2</span><span style="color:#666">*</span>lambd <span style="color:#666">+</span> <span style="color:#666">4</span>) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>            (<span style="color:#666">2</span> <span style="color:#666">&lt;</span> lambd <span style="color:#666">&lt;=</span><span style="color:#666">4</span>)<span style="color:#666">*</span>(<span style="color:#666">-</span><span style="color:#666">5</span><span style="color:#666">*</span>lambd<span style="color:#666">/</span><span style="color:#666">2</span> <span style="color:#666">+</span> <span style="color:#666">5</span>) <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>            (<span style="color:#666">4</span> <span style="color:#666">&lt;</span> lambd <span style="color:#666">&lt;=</span> <span style="color:#666">6</span>)<span style="color:#666">*</span>(<span style="color:#666">-</span>lambd<span style="color:#666">**</span><span style="color:#666">2</span><span style="color:#666">/</span><span style="color:#666">4</span> <span style="color:#666">-</span> lambd<span style="color:#666">/</span><span style="color:#666">2</span> <span style="color:#666">+</span><span style="color:#666">1</span>) <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>            (lambd <span style="color:#666">&gt;=</span> <span style="color:#666">6</span>)<span style="color:#666">*</span>(<span style="color:#666">-</span><span style="color:#666">7</span><span style="color:#666">*</span>lambd<span style="color:#666">/</span><span style="color:#666">2</span> <span style="color:#666">+</span><span style="color:#666">10</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>p <span style="color:#666">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#a2f;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> lambd:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    p<span style="color:#666">.</span>append(phi(i))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>fig <span style="color:#666">=</span> plt<span style="color:#666">.</span>figure()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>ax <span style="color:#666">=</span> fig<span style="color:#666">.</span>add_subplot(<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>ax<span style="color:#666">.</span>set_xlabel(<span style="color:#b44">r</span><span style="color:#b44">&#39;$\lambda$&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>ax<span style="color:#666">.</span>set_ylabel(<span style="color:#b44">r</span><span style="color:#b44">&#39;$\phi$&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>ax<span style="color:#666">.</span>plot(lambd, p, <span style="color:#b44">&#39;-k&#39;</span>)</span></span></code></pre></div>
</div>
<p><img src="img/lagr5.png" alt="img/lagr5.png" title="img/lagr5.png" /></p>
</div>
</div>
<div id="outline-container-headline-13" class="outline-4">
<h4 id="headline-13">
Maximize the dual objective function
</h4>
<div id="outline-text-headline-13" class="outline-text-4">
<p>
As we can see from the plot, the dual objective function $\phi$ is maximized at $\lambda^* = 0$.</p>
</div>
</div>
<div id="outline-container-headline-14" class="outline-4">
<h4 id="headline-14">
The final solution
</h4>
<div id="outline-text-headline-14" class="outline-text-4">
<p>
With the maximum of the dual objective function we can go back to when we found the minimum of the lagrangian function, there we find that for $\lambda^*=0$ the values that minimize the lagrangian are</p>
\begin{equation}
x_1^* = 1 \qquad \text{and} \qquad x_2^*=-1
\end{equation}
<p>
Since we have maximized $\phi$ and minimized $\mathcal{L}$ we also obtained the solution of the original nested problem $\mathbb{P}$.</p>
</div>
</div>
<div id="outline-container-headline-15" class="outline-4">
<h4 id="headline-15">
Visualize the final solution
</h4>
<div id="outline-text-headline-15" class="outline-text-4">
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>fig <span style="color:#666">=</span> plt<span style="color:#666">.</span>figure(figsize<span style="color:#666">=</span>(<span style="color:#666">10</span>,<span style="color:#666">10</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>ax <span style="color:#666">=</span> fig<span style="color:#666">.</span>add_subplot(<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>ax<span style="color:#666">.</span>set_ylabel(<span style="color:#b44">&#39;y&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>ax<span style="color:#666">.</span>set_xlabel(<span style="color:#b44">&#39;x&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>ax<span style="color:#666">.</span>set_aspect(<span style="color:#b44">&#39;equal&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>ax<span style="color:#666">.</span>set_ylim(<span style="color:#666">-</span><span style="color:#666">2</span>, <span style="color:#666">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>CS <span style="color:#666">=</span> ax<span style="color:#666">.</span>contour(X1, X2, X3, colors<span style="color:#666">=</span><span style="color:#b44">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>ax<span style="color:#666">.</span>clabel(CS)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>ax<span style="color:#666">.</span>plot(xr1, xr2, <span style="color:#b44">&#39;k&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>ax<span style="color:#666">.</span>fill_between(xr1, xr2, <span style="color:#666">-</span><span style="color:#666">2</span>, alpha<span style="color:#666">=</span><span style="color:#666">0.4</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>ax<span style="color:#666">.</span>plot(<span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#b44">&#39;or&#39;</span>, ms<span style="color:#666">=</span><span style="color:#666">20</span>)</span></span></code></pre></div>
</div>
<p><img src="img/lagr6.png" alt="img/lagr6.png" title="img/lagr6.png" /></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-16" class="outline-2">
<h2 id="headline-16">
Conclusion
</h2>
<div id="outline-text-headline-16" class="outline-text-2">
<p>
The problem was solved.</p>
</div>
</div>

    </div>
  </article>

   

<hr />
<h2>See Also</h2>
<ul>
  
  <li><a href="../../notes/lagrange-multiplier/">Lagrange multipliers example</a></li>
  
</ul>



  
  




  <div class="blog-post-comments">
    
      <div id="disqus_thread">
  <script type="text/javascript">
    (function() {
      
      
      
      
    
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'nasseralkmim';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

    
  </div>



  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="../../">home</a></li>
         
          <li><a href="../../notes">notes</a></li>
         
          <li><a href="../../tags">tags</a></li>
         
          <li><a href="../../about">about</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
<ul>
<li><a href="#headline-1">Introduction</a>
</li>
<li><a href="#headline-2">Problem statement</a>
<ul>
<li><a href="#headline-3">Visualization of the objective function</a>
</li>
<li><a href="#headline-4">Visualization of the restrained domain</a>
</li>
<li><a href="#headline-5">Visualization with contour plot </a>
</li>
</ul>
</li>
<li><a href="#headline-6">Optimize with Lagrangian duality</a>
<ul>
<li><a href="#headline-7">Form the Lagrangian function </a>
</li>
<li><a href="#headline-8">Compute the function derivatives</a>
</li>
<li><a href="#headline-9">Minimization procedure</a>
</li>
<li><a href="#headline-10">Find the minimum for each variable</a>
</li>
<li><a href="#headline-11">Form the dual objective function</a>
</li>
<li><a href="#headline-12">Visualize the dual objective function</a>
</li>
<li><a href="#headline-13">Maximize the dual objective function</a>
</li>
<li><a href="#headline-14">The final solution</a>
</li>
<li><a href="#headline-15">Visualize the final solution</a>
</li>
</ul>
</li>
<li><a href="#headline-16">Conclusion</a>
</li>
</ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&text=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&title=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&is_video=false&description=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Lagrangian%20duality%20example%20using%20ob-python&body=Check out this article: https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&title=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&title=Lagrangian%20duality%20example%20using%20ob-python" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&name=Lagrangian%20duality%20example%20using%20ob-python&description=Lagrandian%20duality%20example" aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnasseralkmim.github.io%2fnotes%2flagrange-duality%2f&t=Lagrangian%20duality%20example%20using%20ob-python" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2024  Nasser 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="../../">home</a></li>
         
        <li><a href="../../notes">notes</a></li>
         
        <li><a href="../../tags">tags</a></li>
         
        <li><a href="../../about">about</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=../../lib/font-awesome/css/all.min.css>
<script src=../../lib/jquery/jquery.min.js></script>
<script src=../../js/main.js></script>

<script src=../../js/code-copy.js></script>



  


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

</html>
